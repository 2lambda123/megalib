#!/bin/bash

GOOD="yes"
DIR="MEGAlib"
LINKTODIR="/tmp/871264n782d0nrbncxr804x7ngd9ygn9gc79y4gn94mgvzyg497"

if [[ ${GOOD} == "yes" ]] && [[ $# -ne 1 ]] ; then
  echo "mlink: No directory given!"
  GOOD="NO!"
else 
  LINKTODIR=$1
fi

LINKTODIR=$1

if [[ ${GOOD} == "yes" ]] && [[ ! -d ${LINKTODIR} ]]; then
  echo "mlink: Directory $1 does not exit"
  GOOD="NO!"
fi 

if [[ ${GOOD} == "yes" ]] && [[ ! -L ${DIR} ]]; then
  if [[ -d ${DIR} ]]; then
    echo "mlink: ${DIR} is a real directory, no symbolic link!"
    GOOD="NO!"
  fi 
fi

if [[ ${GOOD} == "yes" ]]; then
  rm -f ${DIR}
  ln -s ${LINKTODIR} ${DIR}
  
  if [[ -f ${DIR}/bin/source-megalib.sh ]]; then
    source ${DIR}/bin/source-megalib.sh
  fi
    
  cd ${DIR}
    
  echo "If everything went correctly you are now in the new MEGAlib directory: ${DIR}"
  echo "If not you didn't call this script with \"source\" and you should exit your shell."
fi

# No exit, since we want to be able to call this via "source"
